<%- layout('layouts/boilerplate') -%>

<div class="row justify-content-center my-5">
  <div class="col-lg-6 col-md-8 col-sm-10">
    <div class="card shadow-sm p-4">
      
      <!-- Heading -->
      <h2 class="text-center mb-4 create-heading">
        <i class="fa-solid fa-user-plus me-2"></i> Create Your Account
      </h2>

      <form method="POST" action="/signup" class="needs-validation" novalidate>
        
        <!-- Email -->
        <div class="form-floating mb-3">
          <input type="email" class="form-control" id="email" name="email" placeholder="Enter email" required>
          <label for="email"><i class="fa-solid fa-envelope me-1"></i> Email</label>
          <div class="invalid-feedback">Please enter a valid email.</div>
        </div>

        <!-- Username -->
        <div class="form-floating mb-3">
          <input type="text" class="form-control" id="username" name="username" minlength="3" placeholder="Enter username" required>
          <label for="username"><i class="fa-solid fa-user me-1"></i> Username</label>
          <div class="invalid-feedback">Username must be at least 3 characters.</div>
        </div>

        <!-- Password -->
        <div class="form-floating mb-3 position-relative">
          <input type="password" class="form-control" id="password" name="password" minlength="6" placeholder="Enter password" required>
          <label for="password"><i class="fa-solid fa-lock me-1"></i> Password</label>

          <!-- Show/Hide Button -->
          <button type="button" id="togglePassword" class="btn btn-outline-secondary position-absolute top-50 end-0 translate-middle-y me-2" style="z-index: 5;">
            Show
          </button>
          <div class="invalid-feedback">Password must be at least 6 characters.</div>
        </div>

        <!-- Confirm Password -->
        <div class="form-floating mb-4">
          <input type="password" class="form-control" id="confirmPassword" name="confirmPassword" placeholder="Confirm password" required>
          <label for="confirmPassword"><i class="fa-solid fa-lock me-1"></i> Confirm Password</label>
          <div class="invalid-feedback" id="confirmFeedback">Passwords do not match.</div>
        </div>

        <!-- Submit button -->
        <button type="submit" class="btn btn-pink w-100 btn-lg shadow-sm">Sign Up</button>

        <div class="text-center mt-3">
          <small class="text-center mt-3 text-muted">
            Already have an account?
            <a href="/" class="text-danger text-decoration-none">Log in</a>
          </small>
        </div>
      </form>

    </div>
  </div>
</div>

<!-- Form Validation & Show/Hide Password -->
<script>
(() => {
  const form = document.querySelector('.needs-validation');
  const password = document.getElementById('password');
  const confirmPassword = document.getElementById('confirmPassword');
  const toggle = document.getElementById('togglePassword');
  const confirmFeedback = document.getElementById('confirmFeedback');

  // Show / Hide Password
  toggle.addEventListener('click', () => {
    const type = password.type === 'password' ? 'text' : 'password';
    password.type = confirmPassword.type = type;
    toggle.textContent = type === 'password' ? 'Show' : 'Hide';
  });

  // Validation on Submit
  form.addEventListener('submit', (e) => {
    if (!form.checkValidity()) {
      e.preventDefault();
      e.stopPropagation();
    }

    if (password.value !== confirmPassword.value) {
      confirmPassword.setCustomValidity('Mismatch');
      confirmFeedback.style.display = 'block';
      e.preventDefault();
      e.stopPropagation();
    } else {
      confirmPassword.setCustomValidity('');
    }

    form.classList.add('was-validated');
  });
})();
</script>

<style>
/* Airbnb gradient heading */
.create-heading {
  font-size: 2rem;
  font-weight: 700;
  background: linear-gradient(90deg, #FF385C, #FF7F99);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  position: relative;
}

.create-heading::after {
  content: '';
  display: block;
  width: 60px;
  height: 3px;
  background-color: #FF385C;
  margin: 8px auto 0;
  border-radius: 2px;
}

/* Pink Airbnb theme button */
.btn-pink {
  background-color: #FF385C;
  color: #fff;
  border: none;
  transition: all 0.3s ease;
}

.btn-pink:hover {
  background-color: #e0314b;
  transform: translateY(-2px);
}

/* Input focus effect */
.form-floating > .form-control:focus {
  border-color: #FF385C;
  box-shadow: 0 0 0 0.2rem rgba(255, 56, 92, 0.25);
}

/* Password toggle button */
#togglePassword {
  font-size: 0.9rem;
  padding: 4px 10px;
  color: #FF385C;
  border-color: #FF385C;
}

#togglePassword:hover {
  background-color: #FF385C;
  color: #fff;
}

input[type="password"]::-ms-reveal,
input[type="password"]::-ms-clear {
  display: none;
}

input[type="password"] {
  background-image: none !important;
}
</style>
